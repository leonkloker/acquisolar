2. Schema Mapping (Sample exam question) The ﬁgure below shows a source and a target schema with foreign key constraints (dashed lines) and a logical mapping between them (solid lines).
PID$ Name$ Date_of_Birth$ street$ City$ Zip$ Person' ANR$ Type$ Balance$ A_PID$ Account' Person' name$ Address' Street$ zip$ City' Zip$ City$ Accounts' type$ Account' ANR$ overdra@$ Apply the algorithm discussed in class to identify all interpretations of the given correspondences (i.e., determine all candidate schema mappings). In particular, your solution should include:
a) A list of all identiﬁed intra-schema associations (obtained after deter-
mining primary paths and considering foreign key constraints). To identify each association, provide the set of all bold-font labels associated with an association. For instance, for an association including Product and Busi-
nessSectors from the target schema, write {Product, BusinessSectors}. Give each association a name, using Si (S1, S2, ...) for source associations ans Ti for target associations.
b) Complete the table depicted below. That is, for each association combina-
tion identiﬁed by the pair of source and targer association, say if it is a valid combination or, if not, if it is pruned due to (i) correspondences outgoing from the source that do not ﬁnd a target or (ii) correspondences incoming to the target that do not originate from the source. The ﬁgure with the mappings is repeated for your convenience Source association Target association Is valid?
Invalid due to (i) Invalid due to (ii) 3. GaV modelling We are given the following global and local schemas and integrity constraints (ICs):
Global schema:
Books(title, author, year, category) Local schemas S1: PopularBooks(title, author, year, category) S2: RecentBooks(title, author, year) (IC: year > 2010) S3: AntiqueBooks(title, author, category) S4: NewBooks(title, author, category) (IC: year > 2015) S5: ScienceBooks(title, author) (IC: Jahr = 2016, category = " science") a) Create a Global as View (GaV) model for the above setting.
b) Are there any sources that cannot be modelled and hence not be used for query answering. If so, explain why.
c) Does your model include optional WHERE clauses that are however useful to be modelled as they can provide valuable hints to the query optimizer.
d) For each of the following queries to the global schema, identify the (modelled) sources that • fully contribute to the result • do not contribute to the result and if so, they could however contain relevant data Q1: SELECT * FROM Books Q2: SELECT * FROM Books WHERE year > 2014
Q3: SELECT * FROM Books WHERE category = "fiction" Q4: SELECT * FROM Books WHERE year < 2014
Q5: SELECT * FROM Books WHERE year > 2014 AND category = " science" Q6: SELECT * FROM Books WHERE year > 2014 AND category = " fiction" e) Let us now add the following ICs to the global schema. Which sources cannot be modelled? Brieﬂy explain why.
year > 2010, category = "science" f) Which of the queries Q1 to Q6 given in 3d) can be answered given the ICs added to the global schema in 3e). For those, identify the sources that con-
tribute to the result.
g) Based on the GaV model, we are able to perform query planning, i.e., identify which sources can be used. Using the GaV model analyzed through the above questions, which query will be sent to the next step of query processing (in this case query optimization assuming no data model heterogeneity).
